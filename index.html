<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SDM - Slimmy Devices Monitoring</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  /* Base */
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
  body{background:#f3f4f6;color:#1f2937;line-height:1.5;}
  h1,h2,h3,h4{font-weight:600;color:#111827;}

  /* Header */
  header{background:#4f46e5;color:#fff;padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between;box-shadow:0 4px 12px rgba(0,0,0,0.1);border-radius:0 0 16px 16px;}
  header h1{font-size:1.5rem;letter-spacing:1px;}
  
  /* Main layout */
  main{padding:2rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem;}

  /* Device card */
  .device{background:rgba(255,255,255,0.8);backdrop-filter:blur(8px);border-radius:16px;padding:1rem 1.2rem;box-shadow:0 6px 16px rgba(0,0,0,0.08);}
  .device h2{font-size:1.2rem;margin-bottom:0.5rem;}
  .stats{display:flex;gap:1rem;margin:0.8rem 0;}
  .stat{display:flex;align-items:center;gap:0.3rem;font-size:0.9rem;color:#374151;}
  .stat i{color:#4f46e5;}
  button.view-raw{margin-top:0.8rem;padding:0.5rem 1rem;border:none;border-radius:8px;background:#4f46e5;color:#fff;cursor:pointer;font-weight:600;transition:all 0.2s;}
  button.view-raw:hover{background:#4338ca;}

  /* Modal */
  #modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);backdrop-filter:blur(4px);z-index:9999;}
  #modal-overlay .modal-content{background:#fff;max-width:600px;margin:5% auto;border-radius:16px;padding:1.5rem;position:relative;overflow-y:auto;max-height:80vh;box-shadow:0 10px 25px rgba(0,0,0,0.15);}
  #modal-overlay .modal-content h3{margin-bottom:1rem;color:#4f46e5;}
  #modal-overlay ul{list-style:none;padding:0;display:grid;gap:0.8rem;}
  #modal-overlay li{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0;border-bottom:1px solid #eee;}
  #modal-overlay li i{color:#4f46e5;}
  #modal-overlay a{padding:0.3rem 0.6rem;border-radius:6px;color:#fff;text-decoration:none;font-size:0.85rem;}
  .btn-raw{background:#10b981;}
  .btn-tg{background:#f59e0b;}
  #close-modal{position:absolute;top:1rem;right:1rem;font-size:1.2rem;border:none;background:none;cursor:pointer;color:#374151;}

</style>
</head>
<body>

<header>
  <h1>SDM - Slimmy Devices Monitoring</h1>
  <i class="fas fa-network-wired"></i>
</header>

<main id="device-container">
  <!-- Device cards akan di-render oleh JS -->
</main>

<!-- Modal -->
<div id="modal-overlay">
  <div class="modal-content">
    <button id="close-modal"><i class="fas fa-times"></i></button>
    <h3 id="modal-title">Raw Data - Device</h3>
    <ul id="file-list"></ul>
  </div>
</div>

<script>
  // Contoh data device, nanti bisa diganti API Telegram
  const devices = [
    {id:'STB001',name:'TV Box 1',cpu:25,memory:17,hashrate:1200},
    {id:'STB002',name:'TV Box 2',cpu:35,memory:22,hashrate:980}
  ];

  const container = document.getElementById('device-container');

  devices.forEach(device => {
    const card = document.createElement('div');
    card.className='device';
    card.innerHTML=`
      <h2>${device.name}</h2>
      <p><i class="fas fa-id-badge"></i> ID: ${device.id}</p>
      <div class="stats">
        <div class="stat"><i class="fas fa-microchip"></i><span>${device.cpu}% CPU</span></div>
        <div class="stat"><i class="fas fa-memory"></i><span>${device.memory}% RAM</span></div>
        <div class="stat"><i class="fas fa-bolt"></i><span>${device.hashrate} H/s</span></div>
      </div>
      <canvas id="chart-${device.id}" height="120"></canvas>
      <button class="view-raw" data-device="${device.id}"><i class="fas fa-folder-open"></i> View Raw Data</button>
    `;
    container.appendChild(card);

    const ctx = document.getElementById(`chart-${device.id}`).getContext('2d');
    new Chart(ctx,{
      type:'bar',
      data:{
        labels:['CPU','Memory','Hashrate'],
        datasets:[{
          label: device.name,
          data:[device.cpu, device.memory, device.hashrate],
          backgroundColor:['#4f46e5','#10b981','#f59e0b'],
          borderRadius:6
        }]
      },
      options:{
        responsive:true,
        plugins:{ legend:{ display:false } },
        scales:{
          y:{ beginAtZero:true, grid:{ color:'rgba(0,0,0,0.05)' } },
          x:{ grid:{ color:'rgba(0,0,0,0.05)' } }
        }
      }
    });
  });

  // Modal logic
  const modal = document.getElementById('modal-overlay');
  const closeModal = document.getElementById('close-modal');
  const modalTitle = document.getElementById('modal-title');
  const fileList = document.getElementById('file-list');

  document.querySelectorAll('.view-raw').forEach(btn => {
      btn.addEventListener('click', () => {
          const deviceId = btn.getAttribute('data-device');
          modalTitle.textContent = `Raw Data - ${deviceId}`;
          fileList.innerHTML = ''; // clear previous
          // Contoh static files
          const files = [
              { name:'log_2026-01-22.txt', raw:'#', telegram:'#' },
              { name:'hash_2026-01-22.json', raw:'#', telegram:'#' },
              { name:'stats_2026-01-22.csv', raw:'#', telegram:'#' }
          ];
          files.forEach(f=>{
              const li = document.createElement('li');
              li.innerHTML=`
                <div style="display:flex;align-items:center;gap:0.5rem;">
                  <i class="fas fa-file-alt"></i> ${f.name}
                </div>
                <div style="display:flex;gap:0.5rem;">
                  <a href="${f.raw}" target="_blank" class="btn-raw"><i class="fas fa-eye"></i> View Raw</a>
                  <a href="${f.telegram}" target="_blank" class="btn-tg"><i class="fab fa-telegram-plane"></i> Open TG</a>
                </div>
              `;
              fileList.appendChild(li);
          });
          modal.style.display='block';
      });
  });

  closeModal.addEventListener('click', ()=>{ modal.style.display='none'; });

</script>

</body>
</html>
